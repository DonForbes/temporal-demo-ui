<!DOCTYPE html>

<html xmlns:th="https://www.thymeleaf.org" th:replace="~{fragments/layout :: layout (~{::body},'home')}">

<body>
    <div class="container">
        <div class="card">
            <div class="card-body">
                <h2 class="card-title" th:text="'Temporal Demonstrations : ' + ${appName}"
                    style="color:rgb(102, 179,73);">Temporal Demos : </h2>
                <h6>Details page - TODO.
                </h6>
                <div class="form-group">
                    <br /><br /><br />
                    <h5>Select the transfer details and amount.</h5>
                    <form action="http://localhost:8090/money-transfer" , id="moneytransferform">
                        <table id="accounts" class="table">
                            <tr>
                                <td><label for="fromAccount">From Account:</label></td>
                                <td><select id="fromAccount" name="fromAccount">
                                        <option value="savings">Savings</option>
                                        <option value="current">Current</option>
                                    </select></td>
                            <tr>
                                <td><label for="toAccount">To Account:</label></td>
                                <td><select id="toAccount" name="toAccount">
                                    <option th:each="account : ${accounts}" th:value="${account.firstName}"
                                        th:text="${account.firstName} + ' ' + ${account.lastName}"></option>
                                    </option>
                                </select></td>
                            </tr>
                            <tr>
                                <td> <p>Amount:</p></td>
                                <td><input id="amount" type="number" name="amount"/>10</td>
                            </tr>
                            <tr>
                                <td><label for="workflowOptions">Workflow Options</label></td>
                                <td><select id="workflowOptions" name="workflowOptions">
                                    <option th:each="option : ${options}" th:value="${option.option}"
                                        th:text="${option.optionDescription}"></option>
                                    </option>
                                </select></td>
                            </tr>
                        </table>
                        <br>
                        
                         <p>
                            <div style="text-align:center">
                            <input type="submit" value="Transfer Money" class="btn btn-primary" />
                            </div>
                        </p>
                    </form>
                </div>
            </div>
            <div style="width: 18rem;">
                <div>
                    <h5 class="card-title">Workflow result:</h5>
                    <br>
                    <p><b>
                            <div id="result"></div>
                        </b></p>
                    <br>
                </div>
            </div>
        </div>
    </div>
    <script>
        $("#moneytransferform").submit(function (event) {
            event.preventDefault();

            var $form = $(this),
                firstName = $form.find("input[name='firstName']").val(),
                lastName = $form.find("input[name='lastName']").val(),
                url = $form.attr("action");

            $.ajax({
                'url': url,
                'method': 'POST',
                'dataType': 'json',
                'contentType': 'application/json',
                'data': JSON.stringify({
                    "firstName": firstName,
                    "lastName": lastName
                }),
                success: function (response) {
                    $("#result").empty().append(response);
                }
            });
        });

    </script>

</body>

</html>